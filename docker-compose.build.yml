services:

  gpsd-exporter:
    build:
      context: .
      dockerfile: Dockerfile
    image: gpsd-prometheus-exporter:stable
    container_name: gpsd-exporter
    ports:
      - "${EXPORTER_PORT:-9015}:9015"
    environment:
      - GPSD_HOST=${GPSD_HOST:-localhost}
      - GPSD_PORT=${GPSD_PORT:-2947}
      - GEOPOINT_LON=${GEOPOINT_LON:-38.897809878}
      - GEOPOINT_LAT=${GEOPOINT_LAT:--77.036551259}
      - PPS_BUCKET_SIZE=${PPS_BUCKET_SIZE:-250}
      - PPS_BUCKET_COUNT=${PPS_BUCKET_COUNT:-40}
      - PPS_TIME1=${PPS_TIME1}
      - GEO_BUCKET_SIZE=${GEO_BUCKET_SIZE:-0.5}
      - GEO_BUCKET_COUNT=${GEO_BUCKET_COUNT:-40}
      - EXPORTER_PORT=${EXPORTER_PORT:-9015}
      - DEBUG=${DEBUG:-0}
      - VERBOSE=${VERBOSE:-1}
    dns:
      - 8.8.8.8
      - 8.8.4.4
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    # Note: network_mode: host doesn't work on macOS/Docker Desktop
    # Use bridge networking for macOS, or set network_mode: host for Linux only
